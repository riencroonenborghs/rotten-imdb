(()=>{"use strict";class t{constructor(t){this.text=t,this.regExp=/([0-9]{4})|(S([0-9]*)E([0-9]*))|([0-9]*)p/}get query(){let t=[];return this._parts.forEach((e=>{null===e.match(this.regExp)&&t.push(e)})),t.join(" ")}get _parts(){const t=this.text.replace(/\./g," ").split(/[ \/]/);return""===t[t.length-1]&&t.pop(),t}}class e{set title(t){this._title=t}get title(){return this._title}set year(t){this._year=t}get year(){return this._year}set score(t){this._score=t}get score(){return this._score}set state(t){this._state=t}get state(){return this._state}}class s{constructor(t){this.element=document.createElement("div"),this.element.insertAdjacentHTML("beforeend",t)}parse(){const t=[];return this._movies.forEach((e=>{t.push(this._parseMovie(e))})),t}get _movies(){return this.element.querySelectorAll("search-page-result[slot='movie'] ul[slot='list'] search-page-media-row[skeleton='panel']")}_parseMovie(t){const s=this._title(t),r=(t.attributes,this._attribute(t,"releaseyear")),o=this._attribute(t,"tomatometerscore"),i=this._attribute(t,"tomatometerstate");return Object.assign(new e,{title:s,year:r,score:o,state:i})}_title(t){return t.querySelector("a[slot='title']").childNodes[0].nodeValue.split("\n")[1].trim()}_attribute(t,e){return t.attributes.getNamedItem(e).value}}class r{constructor(t){this.query=t,this.baseUrl="https://www.rottentomatoes.com/search?search="}parse(){return fetch(this.url).then((t=>t.text())).then((t=>new s(t).parse()))}get url(){return`${this.baseUrl}${this._encodedQuery}`}get _encodedQuery(){return encodeURI(this.query)}}const o={id:"rottenTomatoesLookup",contexts:["selection"],title:"RottenTomatoes Lookup",onclick:function(e){const s=e.selectionText,o=new t(s);new r(o.query).parse().then((t=>{console.log(t)}))}};chrome.contextMenus.remove(o.id),chrome.contextMenus.create(o)})();